
{%- include functions.html func='get_banner' -%}

{%- include functions.html func='log' level='debug' msg='Get header_transparent value' -%}
{%- assign name = 'header_transparent' -%}
{%- include functions.html func='get_value' default=true -%}
{%- assign header_transparent = return -%}

{%- if has_banner and header_transparent -%}
  {%- assign header_transparent_class = "site-header-transparent" -%}
{%- endif -%}

<header class="site-header {{ header_transparent_class }}" role="banner">

  <div class="wrapper">
    <div class="site-header-inner">
      
      {%- assign default_paths = site.pages | where: "dir", "/" | map: "path" -%}
      {%- assign page_paths = site.header_pages | default: default_paths -%}

      
      <div class="site-brand-inner" rel="author" onclick="window.location='{{ "/" | relative_url }}';" style="cursor:pointer;">
        <div class="site-title-text">{{ site.title | escape }}</span>
        <div class="site-tagline">de Metz à la Mongolie</span>
      </div>
    </div>

</span>

      </span>
      {%- if page_paths -%}
        
        <nav class="site-nav">
          <input type="checkbox" id="nav-trigger" class="nav-trigger" />
          

          <div class="trigger hidden:flex">
            {%- for path in page_paths -%}
              {%- assign my_page = site.pages | where: "path", path | first -%}
              {%- if my_page.title -%}
              <a class="page-link" href="{{ my_page.url | relative_url }}">{{ my_page.title | lowcase | escape }}</a>
              
              {%- endif -%}
            {%- endfor -%}
              </div>
          </div>
        </nav>
      {%- endif -%}
    </div>
  </div>

  <script>
  document.addEventListener('DOMContentLoaded', function() {
    const menuBtn = document.querySelector('label[for="nav-trigger"]'); 
    const menu = document.querySelector('.trigger');                     

    // On s'assure que le menu est caché
    menu.classList.add('hidden');

    menuBtn.addEventListener('click', function(e) {
      e.preventDefault(); // empêche le comportement du checkbox
      menu.classList.toggle('hidden'); // toggle manuel du menu
    });
  });
  </script>

  <!-- bouton ☰ pour mobile -->
  <label for="nav-trigger" class="md:hidden cursor-pointer p-2 text-white z-50 relative">
    ☰
  </label>

  <!-- menu mobile drawer -->
  <div class="trigger fixed top-0 right-0 h-full w-64 bg-black bg-opacity-90 transform translate-x-full transition-transform duration-300 flex flex-col justify-center items-start p-6 space-y-6 md:static md:flex md:flex-row md:bg-transparent md:translate-x-0 md:p-0 md:space-y-0 md:space-x-4">
    {%- for path in page_paths -%}
      {%- assign my_page = site.pages | where: "path", path | first -%}
      {%- if my_page.title -%}
        <a class="page-link text-white hover:text-blue-400 w-full" href="{{ my_page.url | relative_url }}">
          {{ my_page.title | lowcase | escape }}
        </a>
      {%- endif -%}
    {%- endfor -%}
  </div>

  <script>
  document.addEventListener('DOMContentLoaded', function() {
    const menuBtn = document.querySelector('label[for="nav-trigger"]'); 
    const menu = document.querySelector('.trigger');

    // menu caché au départ
    menu.classList.add('translate-x-full');

    menuBtn.addEventListener('click', function(e) {
      e.preventDefault();
      menu.classList.toggle('translate-x-full'); // toggle drawer
    });
  });
  </script>
</header>

<script>
  function initHeader() {
    var lastScrollY = getScrollPos().y;
    var documentElement = document.documentElement;

    function storeScrollData() {
      var y = getScrollPos().y;

      {%- if banner and header_transparent -%}
      documentElement.setAttribute("data-header-transparent", "");
      {%- endif -%}

      var scrollStatus = "";

      if (y <= 0) {
        scrollStatus = "top";
      } else if ((window.innerHeight + y) >= document.body.offsetHeight) {
        scrollStatus = "bottom";
      } else {
        var isScrollDown = (y - lastScrollY > 0) ? true : false;
        scrollStatus = isScrollDown ? "down" : "up";
      }

      lastScrollY = y;
      documentElement.setAttribute("data-scroll-status", scrollStatus);
    }

    window.addEventListener('scroll', function(e) {
      storeScrollData();
    });

    storeScrollData();
  }
  document.addEventListener('DOMContentLoaded', initHeader);
</script>
